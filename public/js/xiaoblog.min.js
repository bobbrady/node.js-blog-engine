/*! xiaoblog 20-02-2015 */
"use strict";var xiaoBlog=function(){function a(a,b){var c=document.getElementById(a),d=document.getElementById(b);d.innerHTML=marked(c.value)}function b(a,b,c){var d="#"+a,e="#"+b,f="#"+c;$(d).is(":visible")?($(e).html(marked($(d).val())),$(f).html("Edit"),$(d).toggle(),$(e).toggle()):($(f).html("Preview"),$(e).toggle(),$(d).toggle())}function c(a,b,c,d){if(i=b,j=c,k=d,document.getElementById(k).value){l=document.getElementById(k).value.split(",");for(var e=document.getElementById(i),h=0;h<l.length;h++)g(e,l[h])}return $("#"+a).ajaxForm({dataType:"json",success:f}),!1}function d(a,b){$("input[id="+a+"]").change(function(){$("#"+b).val($(this).val().replace("C:\\fakepath\\",""))})}function e(){$("#contact-form").validate({rules:{contactName:{minlength:3,maxlength:20,required:!0},contactEmail:{minlength:3,maxlength:20,required:!0}},highlight:function(a){$(a).closest(".form-group").removeClass("has-success").addClass("has-error")},unhighlight:function(a){$(a).closest(".form-group").removeClass("has-error").addClass("has-success")}}),$("#contact-form").submit(function(a){var b={contactName:$("#contactName").val(),contactEmail:$("#contactEmail").val(),contactMessage:$("#contactMessage").val(),recaptcha:$("#g-recaptcha-response").val()};$.ajax({type:"POST",url:"/contact",data:JSON.stringify(b),dataType:"json",contentType:"application/json"}).done(function(a){h(a)}),a.preventDefault()})}function f(a){var b=a.uploadFile;l.push(b.path.replace("public",""));var c=document.getElementById(i);g(c,b.path),$("#"+j).removeClass("hidden"),document.getElementById(k).value=l.toString()}function g(a,b){var c=document.createElement("li");c.appendChild(document.createTextNode(b.replace("public",""))),a.appendChild(c)}function h(a){a.success?($("#contact-messages").addClass("alert alert-success"),$("#contact-messages").text("Contact form successfully submitted")):($("#contact-messages").addClass("alert alert-danger"),$("#contact-messages").text(a.error))}var i,j,k,l=[];return{markdownToHtml:a,previewMarkdown:b,initXhr:c,captureHiddenFile:d,initContactForm:e}}();